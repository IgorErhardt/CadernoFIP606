{"title":"Análise Não Paramétrica","markdown":{"yaml":{"title":"Análise Não Paramétrica","warning":false},"headingText":"Análise inferencial não paramétrica","containsRefs":false,"markdown":"\n\n\nOs testes não paramétricos são procedimentos estatísticos que não exigem suposições estritas sobre a forma da distribuição dos dados (por exemplo, normalidade). Em vez de trabalharem diretamente com valores observados, muitos deles se baseiam em rankings (posições relativas) ou em contagens de concordâncias/discordâncias, tornando-os mais robustos a outliers, assimetrias ou pequenas amostras. Podemos distinguilos entre pareados ou não pareados em função da depêndencia das amostras.\n\n```{R}\n# Importação de bibliotecas\nlibrary(gsheet)\nlibrary(ggplot2)\nlibrary(tidyverse)\nlibrary(report)\nlibrary(rstatix)\nlibrary(ggpubr)\nlibrary(emmeans)\nlibrary(multcomp)\nlibrary(multcompView)\nlibrary(agricolae)\nlibrary(dplyr)\n```\n\n### Teste de Wilcoxon (Mann-Whitney)\n\n### Pareado\n\nUtilizando o teste de wilcoxon podemos identificar se há diferença entre dois grupos com observações indepentes ou depentes. A partir da combinação de dois grupos ordena-se um ranking total, e proseggue com a investigação a partir da soma dos ranking dos respectivos grupos.\n\nNa versão pareada, são rankeadas as diferenças diferentes de 0 entre cada par. Então é realizada a soma das diferenças positivas e negativas, adotando o menor valor. Para conjunto pequenos (até 25 observações) utiliza-se a tabela de Wilcoxon para determinar o p-valor. Para grandes conjuntos adota-se a aproximação normal.\n\n$$\nd_i = x_i - y_i,\\quad i=1,\\dots,n \\\\ \\\\R_i : \\text{posto de }|d_i|\n$$\n\n$$\nW = \\sum_{d_i>0} R_i,$$\n\n$$\nW = \\min(W^+,W^-)\n$$\n\nUtilizando um conjunto de dados em que foi observado uma classificação por múltiplos avaliadores com e sem auxílio de uma escala, podemos exemplificar a aplicação de um teste de willcox pareado para identificarmos se houve diferença na performance da avaliação mediante ao uso da escala. Antes de execução do teste podemos averiguar que não há homocedasticidade ou distribuição normal do conjunto de dados, utilizando o teste F e o teste de Shapiro Wilk. Prosseguindo com o teste de Wilcox pareado, podemos observar que há diferença significativa entre os grupos.\n\n```{R}\nScaleDataframe = gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1729131173#gid=1729131173\")\n\nUnaided = ScaleDataframe %>%\n  filter(assessment==\"Unaided\") %>%\n  dplyr::select(acuracia) %>%\n  pull()\n\nAided = ScaleDataframe %>%\n  filter(assessment==\"Aided1\") %>%\n  dplyr::select(acuracia) %>%\n  pull()\n\nvar.test(Unaided, Aided)\nshapiro.test(Unaided)\nshapiro.test(Aided)\n\nwilcox.test(Unaided, Aided, paired=TRUE)\n```\n\n#### Não pareado\n\nUtilizando um conjunto de dados relacionado a contagem de insetos após explosição a inseticidas utilizaremos o wilcox não pareado para verificar se há diferença entre o spray A e o C. Seguindo o protocolo demonstrado anteriormente, iremos averiguar a normalidade dos resíduos do modelo ajustado pelo teste de Anova utilizando o teste de Shapiro Wilk. Ao observarmos um p-valor menor que 0.05, constatamos que os resíduos não seguem a distribuição normal, invalidando o uso de Anova.\n\n```{R}\nInsectsDataframe = InsectSprays\nInsectsDataframe |>\n  ggplot(aes(spray, count))+\n  geom_boxplot(outlier.color=NULL)+\n  geom_jitter(width=0.1)\nAnovaModel <- aov(count ~ spray, data = InsectsDataframe)\nhist(residuals(AnovaModel), main = \"Histograma dos Resíduos\",\n     xlab='Resíduos', ylab = 'Frequência')\nshapiro.test(residuals(AnovaModel))\n```\n\nDessa forma um alternativa seria utilizar o teste de Willcoxon não pareado. Na sua versão não pareada, a partir das somas dos ranking de cada grupo (R) é calculado U , adotando o menor valor de U encontrado obtem-se o p-valor a partir da distribuição de U. Como teste compara somente dois grupos, podemos selecionar dois inseticidas e compara-los. Observando que há diferença entre os inseticidas A e C.\n\n$$ U_1 \\;=\\; n_1\\,n_2 \\;+\\; \\frac{n_1\\,(n_1 + 1)}{2} \\;-\\; R_1 $$\n\n$$ ou $$\n\n$$ U_2 \\;=\\; n_1\\,n_2 \\;+\\; \\frac{n_2\\,(n_2 + 1)}{2} \\;-\\; R_2 $$\n\n$$\nU = \\min(U_1,U_2)\n$$\n\n```{R}\nInsectsDataframe = InsectSprays\nSprayA = InsectsDataframe |>\n  filter(spray==\"A\") |>\n  dplyr::select(count) |>\n  pull()\n\nSprayC = InsectsDataframe |>\n  filter(spray==\"C\") |>\n  dplyr::select(count) |>\n  pull()\n\nwilcox.test(SprayA, SprayC, paired=FALSE)\n```\n\n### Teste de Kruskall-Wallis\n\nO teste de Kruskall-Wallis permite a comparação de mais de 2 grupos, que não atendem a distribuição normal. Para possibilitar a comparação, ao invés de comprar os valores, performa a organização de todos valores em ranking, e compara a soma do ranking de cada grupo. A hipótese nula (H0) considera que os grupos são iguais, enquanto a hipótese alternativa (H1) considera que há diferença em algum dos grupos. A soma dos ranking ao quadrado divida pelo número de obbservações do respectivo grupo, é normalizada por uma constante construida a partir do número total de observações, e subtraida por um termo de correção que visa centralizar a distribuição de forma em que sob condições de H0 H é igual a aproximadamente.\n\n$$\nH = \\frac{12}{N(N+1)} \\sum_{i=1}^{k} \\frac{R_i^2}{n_i} - 3(N+1)\n$$\n\nO valor de H implica sobre a diferença entre a soma dos rankings, ao ser comparado a uma distribuição chi-quadrado com grau de liberdade k-1. Obtendo assim um p-valor, caso menor do que alfa rejeita-se H0, e afirma-se que há ao menos uma grupo distinto.\n\n```{R}\nInsectsDataframe = InsectSprays\nkruskal(InsectsDataframe$count, InsectsDataframe$spray, group=TRUE, console=TRUE)\n```\n","srcMarkdownNoYaml":"\n\n## Análise inferencial não paramétrica\n\nOs testes não paramétricos são procedimentos estatísticos que não exigem suposições estritas sobre a forma da distribuição dos dados (por exemplo, normalidade). Em vez de trabalharem diretamente com valores observados, muitos deles se baseiam em rankings (posições relativas) ou em contagens de concordâncias/discordâncias, tornando-os mais robustos a outliers, assimetrias ou pequenas amostras. Podemos distinguilos entre pareados ou não pareados em função da depêndencia das amostras.\n\n```{R}\n# Importação de bibliotecas\nlibrary(gsheet)\nlibrary(ggplot2)\nlibrary(tidyverse)\nlibrary(report)\nlibrary(rstatix)\nlibrary(ggpubr)\nlibrary(emmeans)\nlibrary(multcomp)\nlibrary(multcompView)\nlibrary(agricolae)\nlibrary(dplyr)\n```\n\n### Teste de Wilcoxon (Mann-Whitney)\n\n### Pareado\n\nUtilizando o teste de wilcoxon podemos identificar se há diferença entre dois grupos com observações indepentes ou depentes. A partir da combinação de dois grupos ordena-se um ranking total, e proseggue com a investigação a partir da soma dos ranking dos respectivos grupos.\n\nNa versão pareada, são rankeadas as diferenças diferentes de 0 entre cada par. Então é realizada a soma das diferenças positivas e negativas, adotando o menor valor. Para conjunto pequenos (até 25 observações) utiliza-se a tabela de Wilcoxon para determinar o p-valor. Para grandes conjuntos adota-se a aproximação normal.\n\n$$\nd_i = x_i - y_i,\\quad i=1,\\dots,n \\\\ \\\\R_i : \\text{posto de }|d_i|\n$$\n\n$$\nW = \\sum_{d_i>0} R_i,$$\n\n$$\nW = \\min(W^+,W^-)\n$$\n\nUtilizando um conjunto de dados em que foi observado uma classificação por múltiplos avaliadores com e sem auxílio de uma escala, podemos exemplificar a aplicação de um teste de willcox pareado para identificarmos se houve diferença na performance da avaliação mediante ao uso da escala. Antes de execução do teste podemos averiguar que não há homocedasticidade ou distribuição normal do conjunto de dados, utilizando o teste F e o teste de Shapiro Wilk. Prosseguindo com o teste de Wilcox pareado, podemos observar que há diferença significativa entre os grupos.\n\n```{R}\nScaleDataframe = gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1729131173#gid=1729131173\")\n\nUnaided = ScaleDataframe %>%\n  filter(assessment==\"Unaided\") %>%\n  dplyr::select(acuracia) %>%\n  pull()\n\nAided = ScaleDataframe %>%\n  filter(assessment==\"Aided1\") %>%\n  dplyr::select(acuracia) %>%\n  pull()\n\nvar.test(Unaided, Aided)\nshapiro.test(Unaided)\nshapiro.test(Aided)\n\nwilcox.test(Unaided, Aided, paired=TRUE)\n```\n\n#### Não pareado\n\nUtilizando um conjunto de dados relacionado a contagem de insetos após explosição a inseticidas utilizaremos o wilcox não pareado para verificar se há diferença entre o spray A e o C. Seguindo o protocolo demonstrado anteriormente, iremos averiguar a normalidade dos resíduos do modelo ajustado pelo teste de Anova utilizando o teste de Shapiro Wilk. Ao observarmos um p-valor menor que 0.05, constatamos que os resíduos não seguem a distribuição normal, invalidando o uso de Anova.\n\n```{R}\nInsectsDataframe = InsectSprays\nInsectsDataframe |>\n  ggplot(aes(spray, count))+\n  geom_boxplot(outlier.color=NULL)+\n  geom_jitter(width=0.1)\nAnovaModel <- aov(count ~ spray, data = InsectsDataframe)\nhist(residuals(AnovaModel), main = \"Histograma dos Resíduos\",\n     xlab='Resíduos', ylab = 'Frequência')\nshapiro.test(residuals(AnovaModel))\n```\n\nDessa forma um alternativa seria utilizar o teste de Willcoxon não pareado. Na sua versão não pareada, a partir das somas dos ranking de cada grupo (R) é calculado U , adotando o menor valor de U encontrado obtem-se o p-valor a partir da distribuição de U. Como teste compara somente dois grupos, podemos selecionar dois inseticidas e compara-los. Observando que há diferença entre os inseticidas A e C.\n\n$$ U_1 \\;=\\; n_1\\,n_2 \\;+\\; \\frac{n_1\\,(n_1 + 1)}{2} \\;-\\; R_1 $$\n\n$$ ou $$\n\n$$ U_2 \\;=\\; n_1\\,n_2 \\;+\\; \\frac{n_2\\,(n_2 + 1)}{2} \\;-\\; R_2 $$\n\n$$\nU = \\min(U_1,U_2)\n$$\n\n```{R}\nInsectsDataframe = InsectSprays\nSprayA = InsectsDataframe |>\n  filter(spray==\"A\") |>\n  dplyr::select(count) |>\n  pull()\n\nSprayC = InsectsDataframe |>\n  filter(spray==\"C\") |>\n  dplyr::select(count) |>\n  pull()\n\nwilcox.test(SprayA, SprayC, paired=FALSE)\n```\n\n### Teste de Kruskall-Wallis\n\nO teste de Kruskall-Wallis permite a comparação de mais de 2 grupos, que não atendem a distribuição normal. Para possibilitar a comparação, ao invés de comprar os valores, performa a organização de todos valores em ranking, e compara a soma do ranking de cada grupo. A hipótese nula (H0) considera que os grupos são iguais, enquanto a hipótese alternativa (H1) considera que há diferença em algum dos grupos. A soma dos ranking ao quadrado divida pelo número de obbservações do respectivo grupo, é normalizada por uma constante construida a partir do número total de observações, e subtraida por um termo de correção que visa centralizar a distribuição de forma em que sob condições de H0 H é igual a aproximadamente.\n\n$$\nH = \\frac{12}{N(N+1)} \\sum_{i=1}^{k} \\frac{R_i^2}{n_i} - 3(N+1)\n$$\n\nO valor de H implica sobre a diferença entre a soma dos rankings, ao ser comparado a uma distribuição chi-quadrado com grau de liberdade k-1. Obtendo assim um p-valor, caso menor do que alfa rejeita-se H0, e afirma-se que há ao menos uma grupo distinto.\n\n```{R}\nInsectsDataframe = InsectSprays\nkruskal(InsectsDataframe$count, InsectsDataframe$spray, group=TRUE, console=TRUE)\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"AnáliseInferencial_NParam.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","editor":"visual","theme":"cosmo","title":"Análise Não Paramétrica"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}