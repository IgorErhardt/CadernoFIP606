{
  "hash": "7bc2fac53394e4cb9bc25031006b6663",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Análise Não Paramétrica\"\nwarning: False\n---\n\n\n\n\n## Análise inferencial não paramétrica\n\nOs testes não paramétricos são procedimentos estatísticos que não exigem suposições estritas sobre a forma da distribuição dos dados (por exemplo, normalidade). Em vez de trabalharem diretamente com valores observados, muitos deles se baseiam em rankings (posições relativas) ou em contagens de concordâncias/discordâncias, tornando-os mais robustos a outliers, assimetrias ou pequenas amostras. Podemos distinguilos entre pareados ou não pareados em função da depêndencia das amostras.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Importação de bibliotecas\nlibrary(gsheet)\nlibrary(ggplot2)\nlibrary(tidyverse)\nlibrary(report)\nlibrary(rstatix)\nlibrary(ggpubr)\nlibrary(emmeans)\nlibrary(multcomp)\nlibrary(multcompView)\nlibrary(agricolae)\nlibrary(dplyr)\n```\n:::\n\n\n\n\n### Teste de Wilcoxon (Mann-Whitney)\n\n### Pareado\n\nUtilizando o teste de wilcoxon podemos identificar se há diferença entre dois grupos com observações indepentes ou depentes. A partir da combinação de dois grupos ordena-se um ranking total, e proseggue com a investigação a partir da soma dos ranking dos respectivos grupos.\n\nNa versão pareada, são rankeadas as diferenças diferentes de 0 entre cada par. Então é realizada a soma das diferenças positivas e negativas, adotando o menor valor. Para conjunto pequenos (até 25 observações) utiliza-se a tabela de Wilcoxon para determinar o p-valor. Para grandes conjuntos adota-se a aproximação normal.\n\n$$\nd_i = x_i - y_i,\\quad i=1,\\dots,n \\\\ \\\\R_i : \\text{posto de }|d_i|\n$$\n\n$$\nW = \\sum_{d_i>0} R_i,$$\n\n$$\nW = \\min(W^+,W^-)\n$$\n\nUtilizando um conjunto de dados em que foi observado uma classificação por múltiplos avaliadores com e sem auxílio de uma escala, podemos exemplificar a aplicação de um teste de willcox pareado para identificarmos se houve diferença na performance da avaliação mediante ao uso da escala. Antes de execução do teste podemos averiguar que não há homocedasticidade ou distribuição normal do conjunto de dados, utilizando o teste F e o teste de Shapiro Wilk. Prosseguindo com o teste de Wilcox pareado, podemos observar que há diferença significativa entre os grupos.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nScaleDataframe = gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1729131173#gid=1729131173\")\n\nUnaided = ScaleDataframe %>%\n  filter(assessment==\"Unaided\") %>%\n  dplyr::select(acuracia) %>%\n  pull()\n\nAided = ScaleDataframe %>%\n  filter(assessment==\"Aided1\") %>%\n  dplyr::select(acuracia) %>%\n  pull()\n\nvar.test(Unaided, Aided)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tF test to compare two variances\n\ndata:  Unaided and Aided\nF = 20.978, num df = 9, denom df = 9, p-value = 0.000106\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n  5.210754 84.459185\nsample estimates:\nratio of variances \n          20.97847 \n```\n\n\n:::\n\n```{.r .cell-code}\nshapiro.test(Unaided)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  Unaided\nW = 0.7748, p-value = 0.007155\n```\n\n\n:::\n\n```{.r .cell-code}\nshapiro.test(Aided)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  Aided\nW = 0.92852, p-value = 0.4335\n```\n\n\n:::\n\n```{.r .cell-code}\nwilcox.test(Unaided, Aided, paired=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  Unaided and Aided\nV = 0, p-value = 0.005889\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n:::\n\n\n\n\n#### Não pareado\n\nUtilizando um conjunto de dados relacionado a contagem de insetos após explosição a inseticidas utilizaremos o wilcox não pareado para verificar se há diferença entre o spray A e o C. Seguindo o protocolo demonstrado anteriormente, iremos averiguar a normalidade dos resíduos do modelo ajustado pelo teste de Anova utilizando o teste de Shapiro Wilk. Ao observarmos um p-valor menor que 0.05, constatamos que os resíduos não seguem a distribuição normal, invalidando o uso de Anova.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nInsectsDataframe = InsectSprays\nInsectsDataframe |>\n  ggplot(aes(spray, count))+\n  geom_boxplot(outlier.color=NULL)+\n  geom_jitter(width=0.1)\n```\n\n::: {.cell-output-display}\n![](AnáliseInferencial_NParam_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nAnovaModel <- aov(count ~ spray, data = InsectsDataframe)\nhist(residuals(AnovaModel), main = \"Histograma dos Resíduos\",\n     xlab='Resíduos', ylab = 'Frequência')\n```\n\n::: {.cell-output-display}\n![](AnáliseInferencial_NParam_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(residuals(AnovaModel))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  residuals(AnovaModel)\nW = 0.96006, p-value = 0.02226\n```\n\n\n:::\n:::\n\n\n\n\nDessa forma um alternativa seria utilizar o teste de Willcoxon não pareado. Na sua versão não pareada, a partir das somas dos ranking de cada grupo (R) é calculado U , adotando o menor valor de U encontrado obtem-se o p-valor a partir da distribuição de U. Como teste compara somente dois grupos, podemos selecionar dois inseticidas e compara-los. Observando que há diferença entre os inseticidas A e C.\n\n$$ U_1 \\;=\\; n_1\\,n_2 \\;+\\; \\frac{n_1\\,(n_1 + 1)}{2} \\;-\\; R_1 $$\n\n$$ ou $$\n\n$$ U_2 \\;=\\; n_1\\,n_2 \\;+\\; \\frac{n_2\\,(n_2 + 1)}{2} \\;-\\; R_2 $$\n\n$$\nU = \\min(U_1,U_2)\n$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nInsectsDataframe = InsectSprays\nSprayA = InsectsDataframe |>\n  filter(spray==\"A\") |>\n  dplyr::select(count) |>\n  pull()\n\nSprayC = InsectsDataframe |>\n  filter(spray==\"C\") |>\n  dplyr::select(count) |>\n  pull()\n\nwilcox.test(SprayA, SprayC, paired=FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon rank sum test with continuity correction\n\ndata:  SprayA and SprayC\nW = 143.5, p-value = 3.836e-05\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n:::\n\n\n\n\n### Teste de Kruskall-Wallis\n\nO teste de Kruskall-Wallis permite a comparação de mais de 2 grupos, que não atendem a distribuição normal. Para possibilitar a comparação, ao invés de comprar os valores, performa a organização de todos valores em ranking, e compara a soma do ranking de cada grupo. A hipótese nula (H0) considera que os grupos são iguais, enquanto a hipótese alternativa (H1) considera que há diferença em algum dos grupos. A soma dos ranking ao quadrado divida pelo número de obbservações do respectivo grupo, é normalizada por uma constante construida a partir do número total de observações, e subtraida por um termo de correção que visa centralizar a distribuição de forma em que sob condições de H0 H é igual a aproximadamente.\n\n$$\nH = \\frac{12}{N(N+1)} \\sum_{i=1}^{k} \\frac{R_i^2}{n_i} - 3(N+1)\n$$\n\nO valor de H implica sobre a diferença entre a soma dos rankings, ao ser comparado a uma distribuição chi-quadrado com grau de liberdade k-1. Obtendo assim um p-valor, caso menor do que alfa rejeita-se H0, e afirma-se que há ao menos uma grupo distinto.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nInsectsDataframe = InsectSprays\nkruskal(InsectsDataframe$count, InsectsDataframe$spray, group=TRUE, console=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nStudy: InsectsDataframe$count ~ InsectsDataframe$spray\nKruskal-Wallis test's\nTies or no Ties\n\nCritical Value: 54.69134\nDegrees of freedom: 5\nPvalue Chisq  : 1.510845e-10 \n\nInsectsDataframe$spray,  means of the ranks\n\n  InsectsDataframe.count  r\nA               52.16667 12\nB               54.83333 12\nC               11.45833 12\nD               25.58333 12\nE               19.33333 12\nF               55.62500 12\n\nPost Hoc Analysis\n\nt-Student: 1.996564\nAlpha    : 0.05\nMinimum Significant Difference: 8.462804 \n\nTreatments with the same letter are not significantly different.\n\n  InsectsDataframe$count groups\nF               55.62500      a\nB               54.83333      a\nA               52.16667      a\nD               25.58333      b\nE               19.33333     bc\nC               11.45833      c\n```\n\n\n:::\n:::\n",
    "supporting": [
      "AnáliseInferencial_NParam_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}